<div class="feed-distribution">
  <div class="feed-header">
    <h3>Feed Distribution</h3>
    <button class="back-btn" (click)="goBackToDashboard()">Back to Dashboard</button>
  </div>

  <div class="feed-form">
    <div class="field-row">
      <div class="field">
        <label>Farmer ID</label>
        <input type="text" #farmerIdInput [ngModel]="feedForm().farmerId" (ngModelChange)="updateFeedForm('farmerId', $event)" 
               (keydown.enter)="$event.preventDefault(); farmerNameInput.focus()" />
      </div>
      <div class="field">
        <label>Farmer Name</label>
        <input type="text" #farmerNameInput [ngModel]="feedForm().farmerName" (ngModelChange)="updateFeedForm('farmerName', $event)" 
               (keydown.enter)="$event.preventDefault(); feedNameInput.focus()" />
      </div>
    </div>

    <div class="field-row">
      <div class="field">
        <label>Feed Name</label>
        <input type="text" #feedNameInput [ngModel]="feedForm().feedName" (ngModelChange)="updateFeedForm('feedName', $event)" 
               (keydown.enter)="$event.preventDefault(); rateInput.focus()" />
      </div>
      <div class="field">
        <label>Rate</label>
        <input type="number" min="0" step="0.01" #rateInput [ngModel]="feedForm().rate" (ngModelChange)="updateFeedForm('rate', $event)" 
               (keydown.enter)="$event.preventDefault(); saveFeedEntry()" />
      </div>
    </div>

    <div class="actions">
      <button class="save-btn" (click)="saveFeedEntry()">Save Entry</button>
      <button class="reset-btn" (click)="resetForm()">Reset</button>
    </div>
  </div>

  <div class="entries">
    <h4>Feed Entries</h4>
    <div class="table-wrapper" *ngIf="(feedEntries() | slice:0).length; else emptyState">
      <table class="feed-table">
        <thead>
          <tr>
            <th>Farmer ID</th>
            <th>Farmer Name</th>
            <th>Feed Name</th>
            <th>Rate</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          @for (entry of feedEntries(); track $index) {
            <tr>
              <td>{{ entry.farmerId }}</td>
              <td>{{ entry.farmerName }}</td>
              <td>{{ entry.feedName }}</td>
              <td>{{ entry.rate }}</td>
              <td>
                <div class="row-actions">
                  <button class="edit-btn" (click)="editFeedEntry($index)" aria-label="Edit entry">✎</button>
                  <button class="delete-btn" (click)="removeFeedEntry($index)" aria-label="Delete entry">✕</button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
    <ng-template #emptyState>
      <div class="empty">
        <span>No feed entries yet.</span>
      </div>
    </ng-template>
  </div>
</div>

